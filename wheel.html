<html>
    <head>
        <title>Code Wheel</title>
        <link rel="stylesheet" href="style.css" type="text/css" />
        <script src='js/winwheel/Winwheel.min.js'></script>
        <script src="js/TweenMax.min.js"></script>
        <script src="wheel.json"></script>
    </head>
    <body style="background: transparent; width: 1000px">
        <canvas id='canvas' width='1000' height='800'>
            Canvas not supported, use another browser.
        </canvas>
        <img id="pointer" src="pointer.png" />
        <script>
            wheelSegments.forEach(function (s) {
                if (s.size) {
                    s.size = (s.size / 100) * 360;  // Convert percent to degrees
                }
            });
            let theWheel = new Winwheel({
                'numSegments'  : 10,             // Number of segments
                'outerRadius'  : 400,            // The size of the wheel.
                'textFontSize' : 28,             // Font size.
                'segments'     : wheelSegments,  // Definition of all the segments.,
                'animation' :                    // Definition of the animation
                {
                    'type'     : 'spinToStop',
                    'duration' : 7,
                    'spins'    : Math.floor(Math.random() * 9),
                    'callbackFinished' : alertPrize,
                    'callbackSound': playTick
                },
                'textFontFamily': 'Bebas Neue',
                'textFontWeight': 500,
                'textOrientation': 'horizontal',
                'textAlignment': 'center'
            });
 
            let hitAudio = new Audio('sound/hit.ogg');
            function playHit() {
                hitAudio.pause();
                hitAudio.currentTime = 0;
                hitAudio.play();
            }

            let againAudio = new Audio('sound/again.ogg');
            function playAgain() {
                againAudio.pause();
                againAudio.currentTime = 0;
                againAudio.play();
            }
            let breakingNewsAudio = new Audio('sound/breaking-news.ogg');
            function playBreakingNews() {
                breakingNewsAudio.pause();
                breakingNewsAudio.currentTime = 0;
                breakingNewsAudio.play();
            }
            // Called when the animation has finished.
            function alertPrize(indicatedSegment)
            {
                if(indicatedSegment.text === 'Spin Again') {
                    theWheel.rotationAngle = theWheel.rotationAngle % 360;
                    theWheel.animation.spins = Math.floor(Math.random() * 9);
                    window.setTimeout(() => {theWheel.startAnimation()}, 3000);
                    playAgain();
                } else if (indicatedSegment.text === 'Breaking News') {
                    playBreakingNews();
                } else {
                    playHit();
                }
                document.getElementById('winner').textContent = indicatedSegment.text;
            }

            let tickAudio = new Audio('sound/tick.ogg');
            function playTick() {
                tickAudio.pause();
                tickAudio.currentTime = 0;
                tickAudio.play();
            }

            window.setTimeout(() => {theWheel.startAnimation()}, 1000);

        </script>
        <div id="winner">
            
        </div>
    </body>
</html>
